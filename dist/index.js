function e(e,t,i,s){Object.defineProperty(e,t,{get:i,set:s,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){return e&&e.__esModule?e:{default:e}}function o(e){let t;if("object"!=typeof e?t="Invalid provider provided":Array.isArray(e.grammarScopes)?"function"!=typeof e.getIntentions&&(t="Invalid or no getIntentions found on provider"):t="Invalid or no grammarScopes found on provider",void 0!==t)throw console.log("[Intentions] Invalid provider",e),Error(t)}function n(e,t){return[...e.scopeDescriptorForBufferPosition(t).getScopesArray(),"*"]}async function r(e,t,i,s){return u(s,e.grammarScopes)?await e.getIntentions({textEditor:i,bufferPosition:t}):[]}async function l(e,t,i,s){return u(s,e.grammarScopes)?await e.getIntentions({textEditor:i,visibleRange:t}):[]}function a(e,t){let i,s;var o;e instanceof Error?(i=null!==(o=e.stack)&&void 0!==o?o:"",s=e.message):(i=t,s=e),atom.notifications.addError("[Intentions] "+s,{detail:i,dismissable:!0})}function c(e){return e.flat().filter((e=>null!==e&&"object"==typeof e))}function u(e,t){return e.some((e=>t.includes(e)))}function d(e){Le.context=e}function h(e,t){t&&(He=t);const i=Ae,s=He,o=0===e.length?Ee:{owned:null,cleanups:null,context:null,owner:s,attached:!!t};let n;He=o,Ae=null;try{x((()=>n=e((()=>_(o)))),!0)}finally{Ae=i,He=s}return n}function f(e,t=!0,i){const s={value:e,observers:null,observerSlots:null,pending:Pe,comparator:t?"function"==typeof t?t:ke:void 0};return[L.bind(s),k.bind(s)]}function p(e,t){S(P(e,t,!0))}function v(e,t){S(P(e,t,!1))}function g(e,t,i=!0){const s=P(e,t,!0);return s.pending=Pe,s.observers=null,s.observerSlots=null,s.state=0,s.comparator=i?"function"==typeof i?i:ke:void 0,S(s),L.bind(s)}function m(e){if(_e)return e();const t=_e=[],i=e();return _e=null,x((()=>{for(let e=0;t.length>e;e+=1){const i=t[e];if(i.pending!==Pe){const e=i.pending;i.pending=Pe,k.call(i,e)}}}),!1),i}function b(e){let t,i=Ae;return Ae=null,t=e(),Ae=i,t}function y(...e){const t=e.pop();let i,s,o=!0;return 2>e.length?(i=e[0],o=!1):i=e,e=>{let n;if(o){n=[],s||(s=[]);for(let e=0;i.length>e;e++)n.push(i[e]())}else n=i();const r=b((()=>t(n,s,e)));return s=n,r}}function w(e){return null===He||(null===He.cleanups?He.cleanups=[e]:He.cleanups.push(e)),e}function L(){if(this.state&&this.sources){const e=De;De=null,1===this.state?S(this):H(this),De=e}if(Ae){const e=this.observers?this.observers.length:0;Ae.sources?(Ae.sources.push(this),Ae.sourceSlots.push(e)):(Ae.sources=[this],Ae.sourceSlots=[e]),this.observers?(this.observers.push(Ae),this.observerSlots.push(Ae.sources.length-1)):(this.observers=[Ae],this.observerSlots=[Ae.sources.length-1])}return Te&&Te.running&&Te.sources.has(this)?this.tValue:this.value}function k(e,t){if(this.comparator)if(Te&&Te.running&&Te.sources.has(this)){if(this.comparator(this.tValue,e))return e}else if(this.comparator(this.value,e))return e;return _e?(this.pending===Pe&&_e.push(this),this.pending=e,e):(Te?((Te.running||!t&&Te.sources.has(this))&&(Te.sources.add(this),this.tValue=e),Te.running||(this.value=e)):this.value=e,!this.observers||De&&!this.observers.length||x((()=>{for(let e=0;this.observers.length>e;e+=1){const t=this.observers[e];Te&&Te.running&&Te.disposed.has(t)||(t.observers&&2!==t.state&&A(t),t.state=1,t.pure?De.push(t):Oe.push(t))}if(De.length>1e6)throw De=[],Error("Potential Infinite Loop Detected.")}),!1),e)}function S(e){if(!e.fn)return;_(e);const t=He,i=Ae,s=Ne;Ae=He=e,C(e,e.value,s),Te&&!Te.running&&Te.sources.has(e)&&(Te.running=!0,C(e,e.tValue,s),Te.running=!1),Ae=i,He=t}function C(e,t,i){let s;try{s=e.fn(t)}catch(e){O(e)}e.updatedAt&&e.updatedAt>i||(e.observers&&e.observers.length?k.call(e,s,!0):Te&&Te.running&&e.pure?(Te.sources.add(e),e.tValue=s):e.value=s,e.updatedAt=i)}function P(e,t,i){const s={fn:e,state:1,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:He,context:null,pure:i};return null===He||He!==Ee&&(Te&&Te.running&&He.pure?He.tOwned?He.tOwned.push(s):He.tOwned=[s]:He.owned?He.owned.push(s):He.owned=[s]),s}function E(e){let t,i=1===e.state&&e;if(e.suspense&&b(e.suspense.inFallback))return e.suspense.effects.push(e);const s=Te&&Te.running;for(;(e.fn||s&&e.attached)&&(e=e.owner);){if(s&&Te.disposed.has(e))return;2===e.state?t=e:1===e.state&&(i=e,t=void 0)}if(t){const o=De;if(De=null,H(t),De=o,!i||1!==i.state)return;if(s)for(e=i;(e.fn||e.attached)&&(e=e.owner);)if(Te.disposed.has(e))return}i&&S(i)}function x(e,t){if(De)return e();let i=!1;t||(De=[]),Oe?i=!0:Oe=[],Ne++;try{e()}catch(e){O(e)}finally{(e=>{if(De&&(M(De),De=null),e)return;let t;if(Te&&Te.running){if(Te.promises.size)return Te.running=!1,Te.effects.push.apply(Te.effects,Oe),Oe=null,void Me(!0);const e=Te.sources;t=Te.cb,Te=null,m((()=>{e.forEach((e=>{if(e.value=e.tValue,e.owned)for(let t=0,i=e.owned.length;i>t;t++)_(e.owned[t]);e.tOwned&&(e.owned=e.tOwned),delete e.tValue,delete e.tOwned})),Me(!1)}))}Oe.length?m((()=>{Ce(Oe),Oe=null})):Oe=null,t&&t.forEach((e=>e()))})(i)}}function M(e){for(let t=0;e.length>t;t++)E(e[t])}function H(e){e.state=0;for(let t=0;e.sources.length>t;t+=1){const i=e.sources[t];i.sources&&(1===i.state?E(i):2===i.state&&H(i))}}function A(e){for(let t=0;e.observers.length>t;t+=1){const i=e.observers[t];i.state||(i.state=2,i.observers&&A(i))}}function _(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),i=e.sourceSlots.pop(),s=t.observers;if(s&&s.length){const e=s.pop(),o=t.observerSlots.pop();s.length>i&&(e.sourceSlots[o]=i,s[i]=e,t.observerSlots[i]=o)}}if(Te&&Te.running&&e.pure){if(e.tOwned){for(t=0;e.tOwned.length>t;t++)_(e.tOwned[t]);delete e.tOwned}D(e,!0)}else if(e.owned){for(t=0;e.owned.length>t;t++)_(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;e.cleanups.length>t;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function D(e,t){if(t||(e.state=0,Te.disposed.add(e)),e.owned)for(let t=0;e.owned.length>t;t++)D(e.owned[t])}function O(e){const t=Se&&T(He,Se);if(!t)throw e;t.forEach((t=>t(e)))}function T(e,t){return e&&(e.context&&e.context[t]||e.owner&&T(e.owner,t))}function N(e,t){if(Le.context){const i=Le.context;d({...Le.context,id:`${Le.context.id}${Le.context.count++}.`,count:0});const s=b((()=>e(t)));return d(i),s}return b((()=>e(t)))}function B(e){return g(((e,t,i={})=>{let s=[],o=[],n=[],r=0,l=t.length>1?[]:null,a=He;return w((()=>{for(let e=0,t=n.length;t>e;e++)n[e]()})),()=>{function c(e){if(n[d]=e,l){const[e,i]=f(d);return l[d]=i,t(p[d],e)}return t(p[d])}let u,d,p=e()||[];return b((()=>{let e,t,f,v,g,m,b,y,w,L=p.length;if(0===L){if(0!==r){for(u=0;r>u;u++)n[u]();n=[],s=[],o=[],r=0,l&&(l=[])}i.fallback&&(s=[Be],o[0]=h((e=>(n[0]=e,i.fallback())),a),r=1)}else if(0===r){for(d=0;L>d;d++)s[d]=p[d],o[d]=h(c,a);r=L}else{for(f=Array(L),v=Array(L),l&&(g=Array(L)),m=0,b=Math.min(r,L);b>m&&s[m]===p[m];m++);for(b=r-1,y=L-1;b>=m&&y>=m&&s[b]===p[y];b--,y--)f[y]=o[b],v[y]=n[b],l&&(g[y]=l[b]);for(e=new Map,t=Array(y+1),d=y;d>=m;d--)w=p[d],u=e.get(w),t[d]=void 0===u?-1:u,e.set(w,d);for(u=m;b>=u;u++)w=s[u],d=e.get(w),void 0!==d&&-1!==d?(f[d]=o[u],v[d]=n[u],l&&(g[d]=l[u]),d=t[d],e.set(w,d)):n[u]();for(d=m;L>d;d++)d in f?(o[d]=f[d],n[d]=v[d],l&&(l[d]=g[d],l[d](d))):o[d]=h(c,a);r=o.length=L,s=p.slice(0)}return o}))}})((()=>e.each),e.children,"fallback"in e&&{fallback(){return e.fallback}}||void 0),void 0,!1)}function I(e,t,i){let s=i.length,o=t.length,n=s,r=0,l=0,a=t[o-1].nextSibling,c=null;for(;o>r||n>l;)if(o===r){const t=s>n?l?i[l-1].nextSibling:i[n-l]:a;for(;n>l;)e.insertBefore(i[l++],t)}else if(n===l)for(;o>r;)c&&c.has(t[r])||e.removeChild(t[r]),r++;else if(t[r]===i[l])r++,l++;else if(t[o-1]===i[n-1])o--,n--;else if(t[r]===i[n-1]&&i[l]===t[o-1]){const s=t[--o].nextSibling;e.insertBefore(i[l++],t[r++].nextSibling),e.insertBefore(i[--n],s),t[o]=i[n]}else{if(!c){c=new Map;let e=l;for(;n>e;)c.set(i[e],e++)}const s=c.get(t[r]);if(null!=s)if(s>l&&n>s){let a,u=r,d=1;for(;++u<o&&n>u&&null!=(a=c.get(t[u]))&&a===s+d;)d++;if(d>s-l){const o=t[r];for(;s>l;)e.insertBefore(i[l++],o)}else e.replaceChild(i[l++],t[r++])}else r++;else e.removeChild(t[r++])}}function $(e,t,i){const s=document.createElement("template");if(s.innerHTML=e,t&&s.innerHTML.split("<").length-1!==t)throw`Template html does not match input:\n${s.innerHTML}\n\n${e}`;let o=s.content.firstChild;return i&&(o=o.firstChild),o}function j(e,t,i,s){if(void 0===i||s||(s=[]),"function"!=typeof t)return F(e,t,s,i);v((s=>F(e,t(),s,i)),s)}function V(e){const t="$$"+e.type;let i=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==i&&Object.defineProperty(e,"target",{configurable:!0,value:i}),Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>i});null!==i;){const s=i[t];if(s){const o=i[t+"Data"];if(void 0!==o?s(o,e):s(e),e.cancelBubble)return}i=i.host&&i.host!==i&&i.host instanceof Node?i.host:i.parentNode}}function F(e,t,i,s,o){for(;"function"==typeof i;)i=i();if(t===i)return i;const n=typeof t,r=void 0!==s;if(e=r&&i[0]&&i[0].parentNode||e,"string"===n||"number"===n)if("number"===n&&(t=""+t),r){let o=i[0];o&&3===o.nodeType?o.data=t:o=document.createTextNode(t),i=q(e,i,s,o)}else i=""!==i&&"string"==typeof i?e.firstChild.data=t:e.textContent=t;else if(null==t||"boolean"===n){if(Le.context)return i;i=q(e,i,s)}else{if("function"===n)return v((()=>{let o=t();for(;"function"==typeof o;)o=o();i=F(e,o,i,s)})),()=>i;if(Array.isArray(t)){const n=[];if(G(n,t,o))return v((()=>i=F(e,n,i,s,!0))),()=>i;if(Le.context&&i.length)return i;if(0===n.length){if(i=q(e,i,s),r)return i}else Array.isArray(i)?0===i.length?R(e,n,s):I(e,i,n):null==i||""===i?R(e,n):I(e,r&&i||[e.firstChild],n);i=n}else if(t instanceof Node){if(Array.isArray(i)){if(r)return i=q(e,i,s,t);q(e,i,null,t)}else null!=i&&""!==i&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);i=t}else console.warn("Skipped inserting",t)}return i}function G(e,t,i){let s=!1;for(let o=0,n=t.length;n>o;o++){let n,r=t[o];if(r instanceof Node)e.push(r);else if(null==r||!0===r||!1===r);else if(Array.isArray(r))s=G(e,r)||s;else if("string"==(n=typeof r))e.push(document.createTextNode(r));else if("function"===n)if(i){for(;"function"==typeof r;)r=r();s=G(e,Array.isArray(r)?r:[r])||s}else e.push(r),s=!0;else e.push(document.createTextNode(""+r))}return s}function R(e,t,i){for(let s=0,o=t.length;o>s;s++)e.insertBefore(t[s],i)}function q(e,t,i,s){if(void 0===i)return e.textContent="";const o=s||document.createTextNode("");if(t.length){let s=!1;for(let n=t.length-1;n>=0;n--){const r=t[n];if(o!==r){const t=r.parentNode===e;s||n?t&&e.removeChild(r):t?e.replaceChild(o,r):e.insertBefore(o,i)}else s=!0}}else e.insertBefore(o,i);return[o]}function z(e){function t(t,i){e.selectCallback(t),o(i)}var i;const[s,o]=f(-1),n=((e,t=ke)=>{let i=new Map;const s=P((s=>{const o=e();for(const e of i.keys())if(t(e,o)||void 0!==s&&t(e,s)){const t=i.get(e);for(const e of t.values())e.state=1,e.pure?De.push(e):Oe.push(e)}return o}),void 0,!0);return S(s),e=>{let o;if(o=Ae){let t;(t=i.get(e))?t.add(o):i.set(e,t=new Set([o])),w((()=>{t.size>1?t.delete(o):i.delete(e)}))}return t(e,s.value)}})(s),[r,l]=f("move-to-top"),[a,c]=f(!1);null===(i=e.ref)||void 0===i||i.call(e,{setMovement:l,setConfirmed:c}),p(y(a,(()=>{if(a()){const i=s();t(e.suggestions[i],i)}}))),p(y(r,(()=>{const t=e.suggestions.length,i=s();let n=i;const a=r();"up"===a?n--:"down"===a?n++:"move-to-top"===a?n=0:"move-to-bottom"===a&&(n=t),n%=t,0>n&&(n=t+n),n!==i&&o(n),l(void 0)})));let u="select-list popover-list";return e.suggestions.length>7&&(u+=" intentions-scroll"),(()=>{const i=$e.cloneNode(!0),s=i.firstChild;return i.className=u,j(s,N(B,{get each(){return e.suggestions},children(e,i){const s=i();return(()=>{const i=je.cloneNode(!0),o=i.firstChild;return o.$$click=()=>{t(e,s)},j(o,(()=>e.title)),v((t=>{const r=n(s)?"selected":"",l=e.__$sb_intentions_class;return r!==t._v$&&(i.className=t._v$=r),l!==t._v$2&&(o.className=t._v$2=l),t}),{_v$:void 0,_v$2:void 0}),i})()}})),i})()}function U(){qe=new Re,qe.activate()}function K(){null==qe||qe.dispose()}function J(e){const t=Array.isArray(e)?e:[e];if(void 0!==qe){for(const e of t)qe.consumeListProvider(e);return new X((()=>{if(void 0!==qe)for(const e of t)qe.deleteListProvider(e)}))}}function Q(e){const t=Array.isArray(e)?e:[e];if(void 0!==qe){for(const e of t)qe.consumeHighlightProvider(e);return new X((()=>{if(void 0!==qe)for(const e of t)qe.deleteHighlightProvider(e)}))}}var W=require("atom"),X=W.Disposable,Y=W.Emitter,Z=require("assert"),ee=require("event-kit").Disposable;e(module.exports,"deactivate",(()=>K)),e(module.exports,"consumeHighlightIntentions",(()=>Q)),e(module.exports,"activate",(()=>U)),e(module.exports,"consumeListIntentions",(()=>J));var te={};Object.defineProperty(te,"__esModule",{value:!0}),te.CompositeDisposable=te.Disposable=te.Emitter=void 0;var ie={};Object.defineProperty(ie,"__esModule",{value:!0}),ie.default=void 0;var se=(()=>{function e(e,t){for(var i=0;t.length>i;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return(t,i,s)=>(i&&e(t.prototype,i),s&&e(t,s),t)})(),oe={};Object.defineProperty(oe,"__esModule",{value:!0}),oe.default=void 0;var ne,re=(()=>{function e(e,t){for(var i=0;t.length>i;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return(t,i,s)=>(i&&e(t.prototype,i),s&&e(t,s),t)})(),le=(ne=Z)&&ne.__esModule?ne:{default:ne},ae=function(){function e(t){((e,t)=>{if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")})(0,e),le.default("function"==typeof t,"callback should be a function"),this.callback=t}return re(e,[{key:"dispose",value(){this.callback&&(this.callback(),this.callback=null)}},{key:"disposed",get(){return null===this.callback}}]),e}();oe.default=ae;var ce=oe&&oe.__esModule?oe:{default:oe},ue=function(){function e(){((e,t)=>{if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")})(0,e),this.disposed=!1,this.handlers={}}return se(e,[{key:"on",value(e,t){var i=this;if(this.disposed)throw Error("Emitter has been disposed");if("function"!=typeof t)throw Error("Event handler must be a function");var s=this.handlers[e];return void 0===s?this.handlers[e]=s=[t]:s.push(t),new ce.default((()=>{i.off(e,t)}))}},{key:"off",value(e,t){if(!this.disposed&&this.handlers[e]){var i=this.handlers[e].indexOf(t);-1!==i&&this.handlers[e].splice(i,1)}}},{key:"clear",value(){this.handlers={}}},{key:"emit",value(e){if(this.disposed)return Promise.resolve([]);if(!this.handlers[e])return Promise.resolve([]);for(var t=[],i=this.handlers[e],s=arguments.length,o=Array(s>1?s-1:0),n=1;s>n;n++)o[n-1]=arguments[n];for(var r=0,l=i.length;l>r;++r)t.push(i[r].apply(null,o));return Promise.all(t)}},{key:"dispose",value(){this.disposed=!0,this.clear()}}]),e}();ie.default=ue;var de=s(ie),he=s(oe),fe={};Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var pe=(()=>{function e(e,t){for(var i=0;t.length>i;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return(t,i,s)=>(i&&e(t.prototype,i),s&&e(t,s),t)})(),ve={};Object.defineProperty(ve,"__esModule",{value:!0}),ve.validate=e=>{for(var t=0,i=e.length;i>t;++t){var s=e[t];if(!s||"function"!=typeof s.dispose&&"function"!=typeof s)throw Error("Invalid disposable provided")}};var ge=function(){function e(){i(this,e);for(var t=arguments.length,s=Array(t),o=0;t>o;o++)s[o]=arguments[o];ve.validate(s),this.disposed=!1,this.disposables=new Set(s)}return pe(e,[{key:"add",value(){if(!this.disposed){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];ve.validate(t);for(var s=0,o=t.length;o>s;++s)this.disposables.add(t[s])}}},{key:"delete",value(){if(!this.disposed){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];for(var s=0,o=t.length;o>s;++s)this.disposables.delete(t[s])}}},{key:"clear",value(){this.disposed||this.disposables.clear()}},{key:"dispose",value(){if(!this.disposed){var e=!0,t=!1,i=void 0;try{for(var s,o=this.disposables[Symbol.iterator]();!(e=(s=o.next()).done);e=!0){var n=s.value;"function"==typeof n.dispose?n.dispose():"function"==typeof n&&n()}}catch(e){t=!0,i=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw i}}this.disposed=!0,this.disposables.clear()}}}]),e}();fe.default=ge;var me,be=s(fe);te.Emitter=de.default,te.Disposable=he.default,te.CompositeDisposable=be.default,te.default={Emitter:de.default,Disposable:he.default,CompositeDisposable:be.default},me=(e,t,i,s)=>{if(e.on)e.on(t,i,s);else if(e.addListener)e.addListener(t,i,s);else{if(!e.addEventListener)throw Error("Unknown event emitter");e.addEventListener(t,i,s)}return new ee((()=>{if(e.off)e.off(t,i);else if(e.removeListener)e.removeListener(t,i);else{if(!e.removeEventListener)throw Error("Unknown event emitter");e.removeEventListener(t,i)}}))};const ye=new Set(["core:move-up","core:move-down","core:page-up","core:page-down","core:move-to-top","core:move-to-bottom"]);class we{constructor(){this.active=null,this.emitter=new te.Emitter,this.subscriptions=new te.CompositeDisposable,this.subscriptions.add(this.emitter)}activate(){this.subscriptions.add(atom.commands.add("atom-text-editor:not([mini])",{"intentions:show":async e=>{var i,s;if("list"===(null===(i=this.active)||void 0===i?void 0:i.type))return;const o=new te.CompositeDisposable,n=this.processListShow(o);"keydown"===(null===(s=e.originalEvent)||void 0===s?void 0:s.type)&&(setImmediate((()=>{let e=!0;o.add(atom.keymaps.onDidMatchBinding((({binding:t})=>{e=e&&ye.has(t.command)})),t(me)(document.body,"keyup",(()=>{e||(o.dispose(),this.processListHide())})))})),await n)},"intentions:hide":this.processListHide,"intentions:highlight":async e=>{var i,s;if("highlight"===(null===(i=this.active)||void 0===i?void 0:i.type))return;e.abortKeyBinding();const o=new te.CompositeDisposable,n=this.processHighlightsShow(o);if("keydown"!==(null===(s=e.originalEvent)||void 0===s?void 0:s.type))return;const{code:r}=e.originalEvent;o.add(t(me)(document.body,"keyup",(e=>{e.code===r&&(o.dispose(),this.processHighlightsHide())}))),await n}}),atom.commands.add("atom-text-editor.intentions-list:not([mini])",{"intentions:confirm":this.stoppingEvent(this.processListConfirm),"core:move-up":this.stoppingEvent((()=>this.processListMove("up"))),"core:move-down":this.stoppingEvent((()=>this.processListMove("down"))),"core:page-up":this.stoppingEvent((()=>this.processListMove("page-up"))),"core:page-down":this.stoppingEvent((()=>this.processListMove("page-down"))),"core:move-to-top":this.stoppingEvent((()=>this.processListMove("move-to-top"))),"core:move-to-bottom":this.stoppingEvent((()=>this.processListMove("move-to-bottom")))}))}stoppingEvent(e){return t=>{t.stopImmediatePropagation(),e.call(this,t)}}async processListShow(e=null){if(null!==this.active)switch(this.active.type){case"list":throw Error("Already active");case"highlight":this.processHighlightsHide()}const i=atom.workspace.getActiveTextEditor();if(void 0===i)return;const s=atom.views.getView(i),o=new te.CompositeDisposable;e&&o.add(e),await this.shouldListShow(i)&&(this.active={type:"list",subscriptions:o},o.add((()=>{null!==this.active&&"list"===this.active.type&&this.active.subscriptions===o&&(this.processListHide(),this.active=null),s.classList.remove("intentions-list")}),t(me)(document.body,"mouseup",(()=>{setTimeout((()=>{o.dispose()}),10)}))),s.classList.add("intentions-list"))}processListHide(){var e;if("list"!==(null===(e=this.active)||void 0===e?void 0:e.type))return;const{subscriptions:t}=this.active;this.active=null,t.dispose(),this.emitter.emit("list-hide").catch((e=>a(e)))}processListMove(e){var t;"list"===(null===(t=this.active)||void 0===t?void 0:t.type)&&this.emitter.emit("list-move",e).catch((e=>a(e)))}processListConfirm(){var e;"list"===(null===(e=this.active)||void 0===e?void 0:e.type)&&this.emitter.emit("list-confirm").catch((e=>a(e)))}async processHighlightsShow(e=null){if(null!==this.active)switch(this.active.type){case"highlight":throw Error("Already active");case"list":this.processListHide()}const t=atom.workspace.getActiveTextEditor();if(void 0===t)return;const i=atom.views.getView(t),s=new te.CompositeDisposable,o=await this.shouldHighlightsShow(t);e&&s.add(e),o&&(this.active={type:"highlight",subscriptions:s},s.add((()=>{null!==this.active&&"highlight"===this.active.type&&this.active.subscriptions===s&&this.processHighlightsHide(),i.classList.remove("intentions-highlights")})),i.classList.add("intentions-highlights"))}processHighlightsHide(){var e;if("highlight"!==(null===(e=this.active)||void 0===e?void 0:e.type))return;const{subscriptions:t}=this.active;this.active=null,t.dispose(),this.emitter.emit("highlights-hide").catch((e=>a(e)))}async shouldListShow(e){const t={show:!1,editor:e};return await this.emitter.emit("list-show",t),t.show}async shouldHighlightsShow(e){const t={show:!1,editor:e};return await this.emitter.emit("highlights-show",t),t.show}onListShow(e){return this.emitter.on("list-show",(async t=>{const i=await e(t.editor);t.show=!!i}))}onListHide(e){return this.emitter.on("list-hide",e)}onListMove(e){return this.emitter.on("list-move",e)}onListConfirm(e){return this.emitter.on("list-confirm",e)}onHighlightsShow(e){return this.emitter.on("highlights-show",(async t=>{const i=await e(t.editor);t.show=!!i}))}onHighlightsHide(e){return this.emitter.on("highlights-hide",e)}dispose(){var e;this.subscriptions.dispose(),null===(e=this.active)||void 0===e||e.subscriptions.dispose()}}const Le={},ke=(e,t)=>e===t;let Se=null,Ce=M;const Pe={},Ee={owned:null,cleanups:null,context:null,owner:null},[xe,Me]=f(!1);var He=null,Ae=null;let _e=null,De=null,Oe=null,Te=null,Ne=0;Symbol(),Symbol(),Symbol(),Symbol();const Be=Symbol();(e=>{Symbol()})(),new Set(["className","indeterminate","value","allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","truespeed"]),new Set(["innerHTML","textContent","innerText","children"]),new Set(["beforeinput","click","dblclick","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]);const Ie=Symbol(),$e=$('<div id="intentions-list"><ol class="list-group"></ol></div>',4),je=$("<li><span></span></li>",4);(e=>{const t=document[Ie]||(document[Ie]=new Set);for(let i=0,s=e.length;s>i;i++){const s=e[i];t.has(s)||(t.add(s),document.addEventListener(s,V))}})(["click"]);class Ve{constructor(){this.emitter=new Y,this.element=document.createElement("div"),this.subscriptions=new te.CompositeDisposable,this.subscriptions.add(this.emitter)}activate(e,t){let i;const s=this;((e,o,n)=>{let r;h((e=>{r=e,j(o,N(z,{suggestions:t,selectCallback(e){s.emitter.emit("did-select",e),s.dispose()},ref(e){"function"==typeof i?i(e):i=e}}),o.firstChild?null:void 0,undefined)}))})(0,this.element),this.setMovement=null==i?void 0:i.setMovement,this.setConfirmed=null==i?void 0:i.setConfirmed;const o=e.getCursorBufferPosition(),n=e.markBufferRange([o,o],{invalidate:"never"});e.decorateMarker(n,{type:"overlay",item:this.element}),this.subscriptions.add((()=>{n.destroy()}))}move(e){var t,i=this.setMovement;null===(t=i)||void 0===t||t.call(i,e)}select(){var e,t=this.setConfirmed;null===(e=t)||void 0===e||e.call(t,!0)}onDidSelect(e){return this.emitter.on("did-select",e)}dispose(){this.subscriptions.dispose()}}class Fe{addProvider(e){this.hasProvider(e)||(o(e),this.providers.add(e))}hasProvider(e){return this.providers.has(e)}deleteProvider(e){this.hasProvider(e)&&this.providers.delete(e)}async trigger(e){const t=++this.debounceNumber;if(void 0===e.getPath())return[];const i=e.getCursorBufferPosition(),s=n(e,i),o=[];for(const t of this.providers)o.push(r(t,i,e,s));const l=await Promise.all(o);return t!==this.debounceNumber?[]:(e=>{for(let t=0,{length:i}=e;i>t;++t){const i=e[t],s=[];void 0!==i.class&&""!==i.class&&s.push(i.class.trim()),void 0!==i.icon&&""!==i.icon&&s.push("icon icon-"+i.icon),i.__$sb_intentions_class=s.join(" ")}return e.sort(((e,t)=>t.priority-e.priority))})(c(l))}dispose(){this.providers.clear()}constructor(){this.debounceNumber=0,this.providers=new Set}}class Ge{addProvider(e){this.hasProvider(e)||(o(e),this.providers.add(e))}hasProvider(e){return this.providers.has(e)}deleteProvider(e){this.hasProvider(e)&&this.providers.delete(e)}async trigger(e){const t=++this.debounceNumber;if(void 0===e.getPath())return[];const i=e.getCursorBufferPosition(),s=n(e,i),o={...e.getBuffer().getRange()};o.end.column=1/0;const r=[];for(const t of this.providers)r.push(l(t,o,e,s));const a=await Promise.all(r);return t!==this.debounceNumber?[]:c(a)}dispose(){this.providers.clear()}constructor(){this.debounceNumber=0,this.providers=new Set}}class Re{constructor(){this.active=null,this.commands=new we,this.providersList=new Fe,this.providersHighlight=new Ge,this.subscriptions=new te.CompositeDisposable,this.subscriptions.add(this.commands,this.providersList,this.providersHighlight),this.commands.onListShow((async e=>{const t=await this.providersList.trigger(e);if(!t.length)return!1;const i=new Ve,s=new te.CompositeDisposable;return i.activate(e,t),i.onDidSelect((e=>{e.selected(),s.dispose()})),s.add(i,(()=>{this.active===s&&(this.active=null)}),this.commands.onListMove((e=>{i.move(e)})),this.commands.onListConfirm((()=>{i.select()})),this.commands.onListHide((()=>{s.dispose()}))),this.active=s,!0})),this.commands.onHighlightsShow((async e=>{const t=await this.providersHighlight.trigger(e);if(!t.length)return!1;const i=((e,t)=>{const i=e.addMarkerLayer();for(const o of t){var s;const t=e.getTextInBufferRange(o.range),n=i.markBufferRange(o.range);null===(s=o.created)||void 0===s||s.call(o,{textEditor:e,marker:n,matchedText:t})}return e.decorateMarkerLayer(i,{type:"highlight",class:"intentions-inline"}),()=>{i.clear(),i.destroy()}})(e,t),s=new te.CompositeDisposable;return s.add((()=>{this.active===s&&(this.active=null)}),this.commands.onHighlightsHide((()=>{s.dispose()})),i),this.active=s,!0}))}activate(){this.commands.activate()}consumeListProvider(e){this.providersList.addProvider(e)}deleteListProvider(e){this.providersList.deleteProvider(e)}consumeHighlightProvider(e){this.providersHighlight.addProvider(e)}deleteHighlightProvider(e){this.providersHighlight.deleteProvider(e)}dispose(){this.subscriptions.dispose(),this.active&&this.active.dispose()}}let qe;
//# sourceMappingURL=index.js.map
